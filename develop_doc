ä»¥ä¸‹æ˜¯ä¸ºä½ çš„å•†åŸç³»ç»Ÿè®¾è®¡çš„ä¸€ä»½å®Œæ•´ã€ç®€æ˜ã€é€‚åˆ AI è¾…åŠ©å¼€å‘çš„æ ¸å¿ƒåŠŸèƒ½å¼€å‘æ–‡æ¡£ï¼ˆå¼€å‘è€…è§†è§’ï¼‰ï¼Œé‡‡ç”¨ Fastify + TypeScript æŠ€æœ¯æ ˆã€‚


---

ğŸ›’ Fastify Mall Core - å¼€å‘æ–‡æ¡£ v1.0


1. é¡¹ç›®æ¶æ„æ€»è§ˆ

- æ¡†æ¶ï¼šFastify + TypeScript
- ORMï¼šPrisma
- æ•°æ®åº“ï¼šPostgreSQL
- ç¼“å­˜ï¼šRedisï¼ˆå¯é€‰ï¼‰
- èº«ä»½è®¤è¯ï¼šJWT
- æ’ä»¶ç³»ç»Ÿï¼šåŸºäº Hook + Metadata æ³¨å…¥


ç›®å½•ç»“æ„ï¼š
src/
â”œâ”€â”€ core/              # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ user/
â”‚   â”œâ”€â”€ product/
â”‚   â”œâ”€â”€ order/
â”‚   â”œâ”€â”€ payment/
â”‚   â””â”€â”€ auth/
â”œâ”€â”€ plugins/           # æ’ä»¶ç³»ç»Ÿå…¥å£ï¼ˆåç»­æ‰©å±•ï¼‰
â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”œâ”€â”€ prisma/            # Prisma schema & client
â””â”€â”€ server.ts          # Fastify å¯åŠ¨å…¥å£


---

2. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—


2.1 ç”¨æˆ·æ¨¡å—ï¼ˆsrc/core/userï¼‰


æ¥å£å®šä¹‰

æš‚æ—¶æ— æ³•åœ¨é£ä¹¦æ–‡æ¡£å¤–å±•ç¤ºæ­¤å†…å®¹

æ•°æ®ç»“æ„

User {
  id: string
  email: string
  username: string
  password: string
  avatar?: string
  role: 'user' | 'admin'
  createdAt: Date
  updatedAt: Date
}


---

2.2 å•†å“æ¨¡å—ï¼ˆsrc/core/productï¼‰


æ¥å£å®šä¹‰

æš‚æ—¶æ— æ³•åœ¨é£ä¹¦æ–‡æ¡£å¤–å±•ç¤ºæ­¤å†…å®¹

æ•°æ®ç»“æ„

Product {
  id: string
  name: string
  description?: string
  price: number
  stock: number
  images: string[]
  createdAt: Date
  updatedAt: Date
}


---

2.3 è®¢å•æ¨¡å—ï¼ˆsrc/core/orderï¼‰


æ¥å£å®šä¹‰

æš‚æ—¶æ— æ³•åœ¨é£ä¹¦æ–‡æ¡£å¤–å±•ç¤ºæ­¤å†…å®¹

æ•°æ®ç»“æ„

Order {
  id: string
  userId: string
  items: OrderItem[]
  status: 'pending' | 'paid' | 'cancelled'
  totalAmount: number
  createdAt: Date
}
OrderItem {
  productId: string
  quantity: number
  unitPrice: number
}


---

2.4 æ”¯ä»˜æ¨¡å—ï¼ˆsrc/core/paymentï¼‰


æ¥å£å®šä¹‰

æš‚æ—¶æ— æ³•åœ¨é£ä¹¦æ–‡æ¡£å¤–å±•ç¤ºæ­¤å†…å®¹


---

3. æ’ä»¶ç³»ç»Ÿé¢„ç•™ï¼ˆsrc/pluginsï¼‰

interface Plugin {
  name: string
  register(app: FastifyInstance): Promise<void>
}
æœªæ¥æ”¯æŒè‡ªåŠ¨åŠ è½½ plugins/*.tsï¼Œå¹¶æ‰§è¡Œå…¶ register æ–¹æ³•æŒ‚è½½è·¯ç”±ã€‚

---

4. é‰´æƒå’Œä¸­é—´ä»¶

- æ‰€æœ‰ /api/* æ¥å£ä½¿ç”¨ JWT é‰´æƒä¸­é—´ä»¶
- ç®¡ç†ç«¯æ¥å£éœ€æ ¡éªŒ user.role === 'admin'


---

5. ç¯å¢ƒå˜é‡ï¼ˆ.envï¼‰

DATABASE_URL=postgresql://user:password@localhost:5432/mall
JWT_SECRET=your-secret


---

6. å¯åŠ¨æ–¹å¼

pnpm install
pnpm dev


---

7. æ•°æ®åº“åˆå§‹åŒ–ï¼ˆPrismaï¼‰

npx prisma generate
npx prisma migrate dev --name init


---




